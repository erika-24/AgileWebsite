<!-- pricing.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CardioGuard Pricing</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
</head>

<body>

  <!-- Navbar matches your structure exactly -->
  <header class="navbar">
    <div class="container">
      <h1 class="logo"><a href="index.html">CardioGuard</a></h1>
      <nav>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="index.html#features">Features</a></li>
          <li><a href="index.html#about">About</a></li>
          <li><a href="productsPage.html">Products</a></li>
          <li><a href="pricing.html">Pricing</a></li>
          <li><a href="research.html">Research</a></li>
          <li><a href="faq.html">FAQ</a></li>
          <li><a href="recruit.html">Careers</a></li>
          <li><a href="leadership.html">Leadership</a></li>
          <li><a href="index.html#contact" class="btn">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Hero uses your hero section styling -->
  <section class="hero pricing-hero">
    <div class="container">
      <div class="hero-text">
        <h2>Simple pricing for serious protection.</h2>
        <p>
          CardioGuard is an ecosystem: <strong>hardware + a required membership</strong> that powers continuous monitoring,
          tiered alerts, and (on Guardian tier) no-response escalation so help reaches you or your loved ones when it matters.
        </p>

        <div class="pricing-toggle" aria-label="Billing toggle">
          <button type="button" id="toggleMonthly" class="active">Monthly</button>
          <button type="button" id="toggleAnnual">Annual</button>
        </div>
        <div class="pricing-note" id="billingNote">Tip: Annual saves vs paying monthly.</div>
        <br>
        <a href="#membership" class="btn-primary">Choose a Membership</a>
      </div>

      <div class="hero-image">
        <!-- Use your own asset if you have one; placeholder keeps layout consistent -->
        <img src="images/hero_image.png" alt="CardioGuard wearable heart monitoring" />
      </div>
    </div>
  </section>

  <!-- MEMBERSHIP + SUMMARY -->
  <section id="membership" class="features">
    <div class="container">
      <h3>Membership</h3>

      <div class="pricing-layout">
        <!-- Left: Membership cards -->
        <div class="pricing-grid-2">
          <!-- Essential -->
          <div class="pricing-card" data-plan-card="essential">
            <span class="pricing-badge">Base Plan</span>
            <h4>Essential</h4>
            <p>Continuous monitoring + tiered alerts for everyday confidence.</p>

            <div class="price-row">
              <div class="price" id="essentialPrice">$19</div>
              <div class="per" id="essentialPer">/ month</div>
              <div class="strike" id="essentialStrike" style="display:none;">$228</div>
            </div>

            <ul class="bullets">
              <li>Continuous monitoring + trend insights</li>
              <li>Tiered alerts (Low → Critical)</li>
              <li>Event log + weekly summaries</li>
              <li>1 caregiver contact for notifications</li>
            </ul>

            <div class="btn-row">
              <button class="btn-primary" type="button" data-action="choose-plan" data-plan="essential">Choose Essential</button>
            </div>
          </div>

          <!-- Guardian -->
          <div class="pricing-card" data-plan-card="guardian" style="border: 1px solid rgba(255,255,255,0.22);">
            <span class="pricing-badge">Best for families</span>
            <h4>Guardian</h4>
            <p>Advanced alerts + no-response escalation for you and your circle.</p>

            <div class="price-row">
              <div class="price" id="guardianPrice">$39</div>
              <div class="per" id="guardianPer">/ month</div>
              <div class="strike" id="guardianStrike" style="display:none;">$468</div>
            </div>

            <ul class="bullets">
              <li>Everything in Essential</li>
              <li><strong>No-response escalation</strong> to caregivers</li>
              <li>Up to 4 caregivers + escalation tree</li>
              <li>Priority alerts + detailed reports</li>
            </ul>

            <div class="btn-row">
              <button class="btn-primary" type="button" data-action="choose-plan" data-plan="guardian">Choose Guardian</button>
            </div>
          </div>
        </div>

        <!-- Right: Summary -->
        <aside class="pricing-card summary" aria-label="Kit summary">
          <h4 style="margin-top:0;">Your Kit</h4>
          <p style="margin-top:6px;">Select a membership + devices. Totals update automatically.</p>

          <div class="summary-line">
            <span>Billing</span>
            <strong id="summaryBilling">Monthly</strong>
          </div>
          <div class="summary-line">
            <span>Membership</span>
            <strong id="summaryPlan">Not selected</strong>
          </div>
          <div class="summary-line">
            <span>Devices</span>
            <strong id="summaryDevices">0</strong>
          </div>

          <div class="summary-total">
            <div class="summary-line">
              <span>Due today (hardware)</span>
              <strong id="dueToday">$0</strong>
            </div>
            <div class="summary-line">
              <span>Membership</span>
              <strong id="membershipDue">$0/mo</strong>
            </div>
          </div>

          <div class="btn-row">
            <button class="btn-primary" type="button" id="continueBtn">Continue</button>
            <button class="btn-secondary" type="button" id="resetBtn">Reset</button>
          </div>
        </aside>
      </div>
    </div>
  </section>

  <!-- DEVICES -->
  <section id="devices" class="features">
    <div class="container">
      <h3>Devices (Hardware)</h3>

      <div class="pricing-grid-3">
        <div class="pricing-card" data-device-card="ring">
          <span class="pricing-badge">All-day</span>
          <h4>CardioGuard Ring</h4>
          <p>Wearable ring for continuous cardiac monitoring.</p>

          <div class="price-row">
            <div class="price" id="price-ring">$249</div>
            <div class="per">hardware</div>
          </div>

          <ul class="bullets">
            <li>Tracks HR, SpO₂, rhythm insights</li>
            <li>5–7 day battery + offline storage</li>
            <li>Great default daily-wear option</li>
          </ul>

          <div class="btn-row">
            <button class="btn-primary" type="button" data-action="toggle-device" data-device="ring">Add Ring</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- COMPARE -->
  <section id="compare" class="about">
    <div class="container">
      <div class="about-text">
        <h3>Compare Memberships</h3>
        <p>Both tiers power the CardioGuard ecosystem. Guardian adds no-response escalation and more caregivers.</p>

        <table class="compare-table" aria-label="Membership comparison">
          <thead>
            <tr>
              <th style="width: 44%;">Feature</th>
              <th>Essential</th>
              <th>Guardian</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Continuous monitoring</strong><br><span style="color: rgba(255,255,255,0.6);">Trends, events, summaries</span></td>
              <td class="yes">Yes</td>
              <td class="yes">Yes</td>
            </tr>
            <tr>
              <td><strong>Tiered alerts</strong><br><span style="color: rgba(255,255,255,0.6);">Low → Critical guidance</span></td>
              <td class="yes">Yes</td>
              <td class="yes">Yes + priority</td>
            </tr>
            <tr>
              <td><strong>Caregivers</strong><br><span style="color: rgba(255,255,255,0.6);">Notifications to your circle</span></td>
              <td class="yes">1 contact</td>
              <td class="yes">Up to 4 + tree</td>
            </tr>
            <tr>
              <td><strong>No-response escalation</strong><br><span style="color: rgba(255,255,255,0.6);">Escalate if you don’t respond</span></td>
              <td class="no">—</td>
              <td class="yes">Included</td>
            </tr>
            <tr>
              <td><strong>Reports</strong><br><span style="color: rgba(255,255,255,0.6);">Detailed summaries</span></td>
              <td class="yes">Standard</td>
              <td class="yes">Enhanced</td>
            </tr>
          </tbody>
        </table>
      </div>


    </div>
  </section>

  <!-- FAQ + Contact -->
  <section class="contact" id="faq">
    <div class="container">
      <h3>FAQ</h3>

      <details>
        <summary>Why is membership required?</summary>
        <p>Membership powers the CardioGuard app, alerting, and caregiver workflows. Without it, the ecosystem features are unavailable.</p>
      </details>

      <details>
        <summary>Do I need more than one device?</summary>
        <p>No. CardioGuard Ring is our only device—wear it for continuous cardiac monitoring.</p>
      </details>

      <details>
        <summary>How does no-response escalation work?</summary>
        <p>Guardian attempts to reach you first. If you don’t respond within a defined window, alerts escalate through your caregiver list (placeholder logic for prototype).</p>
      </details>

      <div style="margin-top: 18px;">
        <a href="index.html#contact" class="btn-primary">Still have questions? Contact us</a>
      </div>
    </div>
  </section>

  <footer class="footer">
    <img src="images/Logo - Cardio Guard.png" alt="CardioGuard Logo" class="footer-logo" />
    <p>© 2026 CardioGuard. All rights reserved.</p>
  </footer>

  <div class="toast" id="toast" aria-live="polite"></div>

  <script>
    // --------- Config (edit these numbers anytime) ----------
    const PRICES = {
      billing: "monthly", // "monthly" | "annual"
      plans: {
        essential: { name: "Essential", monthly: 19, annual: 190 },
        guardian:  { name: "Guardian",  monthly: 39, annual: 390 }
      },
      devices: {
        ring: { name: "CardioGuard Ring", price: 249 }
      }
    };

    // --------- State ----------
    const state = {
      billing: PRICES.billing,
      plan: null,
      devices: new Set()
    };

    // --------- Helpers ----------
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    function money(n){
      return n.toLocaleString("en-US", { style: "currency", currency: "USD", maximumFractionDigits: 0 });
    }

    function showToast(msg){
      const t = $("#toast");
      t.textContent = msg;
      t.classList.add("show");
      clearTimeout(showToast._timer);
      showToast._timer = setTimeout(() => t.classList.remove("show"), 1600);
    }

    function setBilling(mode){
      state.billing = mode;

      // Toggle buttons
      $("#toggleMonthly").classList.toggle("active", mode === "monthly");
      $("#toggleAnnual").classList.toggle("active", mode === "annual");

      // Hero note
      $("#summaryBilling").textContent = mode === "monthly" ? "Monthly" : "Annual";
      $("#billingNote").textContent = mode === "monthly"
        ? "Tip: Annual saves vs paying monthly."
        : "Annual billing selected. (Membership billed yearly.)";

      // Update UI for plan pricing
      const e = PRICES.plans.essential;
      const g = PRICES.plans.guardian;

      if(mode === "monthly"){
        $("#essentialPrice").textContent = `$${e.monthly}`;
        $("#essentialPer").textContent = "/ month";
        $("#essentialStrike").style.display = "none";

        $("#guardianPrice").textContent = `$${g.monthly}`;
        $("#guardianPer").textContent = "/ month";
        $("#guardianStrike").style.display = "none";
      } else {
        $("#essentialPrice").textContent = money(e.annual);
        $("#essentialPer").textContent = "/ year";
        $("#essentialStrike").style.display = "inline";
        $("#essentialStrike").textContent = `$${e.monthly * 12}`;

        $("#guardianPrice").textContent = money(g.annual);
        $("#guardianPer").textContent = "/ year";
        $("#guardianStrike").style.display = "inline";
        $("#guardianStrike").textContent = `$${g.monthly * 12}`;
      }

      render();
    }

    function choosePlan(planKey){
      state.plan = planKey;

      // Visual highlight
      $$("[data-plan-card]").forEach(card => {
        const on = card.getAttribute("data-plan-card") === planKey;
        card.style.outline = on ? "2px solid rgba(255,255,255,0.28)" : "none";
      });

      $("#summaryPlan").textContent = PRICES.plans[planKey].name;
      showToast(`Selected ${PRICES.plans[planKey].name}`);
      render();
    }

    function toggleDevice(deviceKey){
      if(state.devices.has(deviceKey)){
        state.devices.delete(deviceKey);
      } else {
        state.devices.add(deviceKey);
      }
      render();
    }

    function resetAll(){
      state.plan = null;
      state.devices = new Set();

      $("#summaryPlan").textContent = "Not selected";
      $$("[data-plan-card]").forEach(card => card.style.outline = "none");

      render();
      showToast("Reset");
    }

    function computeTotals(){
      let hardware = 0;
      for(const k of state.devices) hardware += PRICES.devices[k].price;

      let membership = 0;
      let membershipLabel = state.billing === "monthly" ? "/mo" : "/yr";
      if(state.plan) membership = PRICES.plans[state.plan][state.billing];

      return { hardware, membership, membershipLabel };
    }

    function renderDeviceButtons(){
      $$("[data-action='toggle-device']").forEach(btn => {
        const key = btn.getAttribute("data-device");
        const isOn = state.devices.has(key);
        btn.textContent = isOn ? `Remove ${capitalize(key)}` : `Add ${capitalize(key)}`;
      });

      $$("[data-device-card]").forEach(card => {
        const key = card.getAttribute("data-device-card");
        card.style.outline = state.devices.has(key) ? "2px solid rgba(255,255,255,0.22)" : "none";
      });
    }

    function capitalize(s){ return s.charAt(0).toUpperCase() + s.slice(1); }

    function render(){
      $("#price-ring").textContent = money(PRICES.devices.ring.price);

      $("#summaryDevices").textContent = String(state.devices.size);

      const totals = computeTotals();
      $("#dueToday").textContent = money(totals.hardware);

      if(state.plan){
        $("#membershipDue").textContent = `${money(totals.membership)}${totals.membershipLabel}`;
      } else {
        $("#membershipDue").textContent = state.billing === "monthly" ? "$0/mo" : "$0/yr";
      }

      $("#continueBtn").disabled = !state.plan;
      $("#continueBtn").style.opacity = state.plan ? "1" : "0.6";

      renderDeviceButtons();
    }

    // --------- Events ----------
    $("#toggleMonthly").addEventListener("click", () => setBilling("monthly"));
    $("#toggleAnnual").addEventListener("click", () => setBilling("annual"));

    $$("[data-action='choose-plan']").forEach(btn => {
      btn.addEventListener("click", () => choosePlan(btn.getAttribute("data-plan")));
    });

    $$("[data-action='toggle-device']").forEach(btn => {
      btn.addEventListener("click", () => toggleDevice(btn.getAttribute("data-device")));
    });

    $("#resetBtn").addEventListener("click", resetAll);

    // Restore builder state from URL (deep link) or localStorage.
    const STORAGE_KEY = "cg_checkout_state_v1";
    function applyPrefillFromUrl(){
      const params = new URLSearchParams(window.location.search);
      const billing = params.get("billing");
      const plan = params.get("plan");
      const devices = params.get("devices");

      let touched = false;
      if(billing === "monthly" || billing === "annual"){
        state.billing = billing;
        touched = true;
      }
      if(plan && PRICES.plans[plan]){
        state.plan = plan;
        touched = true;
      }
      if(devices){
        const list = devices.split(",").map(s => s.trim()).filter(Boolean);
        if(list.length){
          state.devices = new Set(list.filter(k => PRICES.devices[k]));
          touched = true;
        }
      }

      if(touched){
        setBilling(state.billing);
        if(state.plan) choosePlan(state.plan);
        render();
      }
    }

    function tryRestoreFromStorage(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return;
        const saved = JSON.parse(raw);
        if(!saved) return;

        if(saved.billing === "monthly" || saved.billing === "annual") state.billing = saved.billing;
        if(saved.plan && PRICES.plans[saved.plan]) state.plan = saved.plan;
        if(Array.isArray(saved.devices)){
          state.devices = new Set(saved.devices.filter(k => PRICES.devices[k]));
        }

        setBilling(state.billing);
        if(state.plan) choosePlan(state.plan);
        render();
      } catch {}
    }

    // Continue → real checkout page (prototype)
    $("#continueBtn").addEventListener("click", () => {
      if(!state.plan){
        showToast("Choose a membership to continue");
        return;
      }

      const payload = {
        billing: state.billing,
        plan: state.plan,
        devices: Array.from(state.devices)
      };

      try{
        localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
      } catch {}

      window.location.href = "checkout.html";
    });

    // Init billing + render
    setBilling(state.billing);
    render();

    // Prefill: URL takes priority, then localStorage
    applyPrefillFromUrl();
    if(!window.location.search) tryRestoreFromStorage();
  </script>
</body>
</html>
